# AI Agents 開発ガイドライン

このドキュメントは、AI Agentがこのプロジェクトでコードを実装する際に従うべきガイドラインを定義します。

---

## 🏗️ アーキテクチャ原則

### 1. クリーンアーキテクチャ（DDD思想）

- **ドメイン駆動設計（DDD）** の思想に従い、クリーンアーキテクチャでコードを実装すること
- ビジネスロジックをインフラストラクチャから分離する
- 依存関係は外側から内側に向かう（依存性逆転の原則）
- ドメイン層は外部の技術詳細に依存しない

**レイヤー構成:**
```
presentation (API routes, controllers)
    ↓
application (use cases, orchestration)
    ↓
domain (entities, value objects, domain services)
    ↓
infrastructure (database, external APIs, implementations)
```

### 2. Feature First アーキテクチャ

- **機能（Feature）ごと**にディレクトリを分割する
- 関連するコード（ルート、サービス、モデル、テスト）を同じディレクトリに配置
- 機能間の結合度を低く保つ

**ディレクトリ例:**
```
src/
├── features/
│   ├── articles/
│   │   ├── domain/
│   │   ├── application/
│   │   ├── infrastructure/
│   │   ├── presentation/
│   │   └── tests/
│   └── categories/
│       ├── domain/
│       ├── application/
│       ├── infrastructure/
│       ├── presentation/
│       └── tests/
└── shared/
    └── (共通ユーティリティ)
```

---

## 📝 コーディング規約

### 3. 変数名の一貫性

- **一貫性のある命名規則**を使用すること
- 同じ概念には同じ名前を使用する（例: `article_id` と `articleId` を混在させない）
- TypeScript/JavaScript: `camelCase`
- Python: `snake_case`
- 定数: `UPPER_SNAKE_CASE`
- クラス/型: `PascalCase`

### 4. ファイル分割の原則

- **100行を優に超えるファイル**はコンポーネント分割を検討すること
- 単一責任の原則（SRP）に従う
- 1ファイル1クラス、1ファイル1責務を基本とする

### 5. DRY原則（Don't Repeat Yourself）

- **コードの重複を避ける**
- 共通ロジックは関数・クラス・モジュールに抽出する
- 同じコードが3回以上現れたら、必ずリファクタリングを検討する

### 6. 拡張性の確保

- **ある程度の拡張性**を持たせること
- インターフェース・抽象クラスを活用する
- ハードコーディングを避け、設定ファイルや環境変数を使用する
- Open/Closed原則に従う（拡張に対して開いており、修正に対して閉じている）

---

## 🧪 テスト戦略

### 7. テストの記述

- **特に重要な個所にはテストを記述**すること
- 以下の箇所は必ずテストを書く:
  - ビジネスロジック（ドメイン層）
  - 外部API連携（インフラ層）
  - データ変換・バリデーション
  - 重要なユースケース

**テストの種類:**
- 単体テスト（Unit Tests）: ドメインロジック、ユーティリティ
- 統合テスト（Integration Tests）: API、データベース
- E2Eテスト（End-to-End Tests）: 主要なユーザーフロー

---

## ✅ 実装チェックリスト

コードを書く際は、以下を確認すること:

- [ ] クリーンアーキテクチャの原則に従っているか
- [ ] Feature First の構造になっているか
- [ ] 変数名は一貫性があるか
- [ ] ファイルは100行以内に収まっているか（超える場合は分割を検討したか）
- [ ] コードの重複がないか（DRY原則）
- [ ] 将来の拡張を考慮した設計になっているか
- [ ] 重要な箇所にテストを書いたか

---

## 📌 注意事項

- このガイドラインは、AI Agentがコードを生成する際の指針です
- プロジェクトの一貫性と品質を保つため、必ず遵守してください
- 既存のコードがこのガイドラインに従っていない場合は、リファクタリングを提案してください
